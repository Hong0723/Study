# 관계 데이터 모델의 개념

**릴레이션의 개념**
- 행과 열로 구성된 테이블을 말함

  
  ![image](https://github.com/user-attachments/assets/0338e1b5-32a7-45dc-9916-daf1dd355465)

**관계(relationship)**

  릴레이션(테이블) 내의 관계와 릴레이션(테이블) 간의 관계가 있음

   - 릴레이션 내의 관계 : 릴레이션 안에 있는 데이터들의 집합으로 표현
   - 릴레이션 간의 관계 : 릴레이션을 식별

**릴레이션**
- 스키마와 인스턴스로 이루어짐

  ![image](https://github.com/user-attachments/assets/7e613552-6cad-40d1-990a-2bd1f00b7b04)

**릴레이션 스키마**
- 속성(attribute) : 릴레이션 스키마의 열
- 도메인(domain) : 속성이 가질 수 있는 값의 집합(어떠한 자료형을 가지며, 값의 제약 조건까지 포함됨)
- 차수(degree) :  속성의 개수

  ![image](https://github.com/user-attachments/assets/a01400ff-70bf-4262-aec6-b5767d54e3c6)

**릴레이션 인스턴스**
- 릴레이션 스키마에 실제로 저장된 데이터의 집합
- 투플(tuple) : 릴레이션의 행
- 카디날리티(cardinality) : 투플의 수

**릴레이션의 특징**
- 속성은 단일 값을 가짐
- 속성은 서로 다른 이름을 가짐
- 한 속성의 값은 모두 같은 도메인 값을 가짐
- 속성의 순서는 상관없음
- 릴레이션 내의 중복된 투플은 허용하지 않음
- 투플의 순서는 상관 없음

# 키

  **키**
 - 무엇인가를 유일하게 식별한다는 의미
 - 관계 데이터베이스에서 키는 릴레이션에서 특정 투플을 식별할때 사용하는 속성 혹은 속성의 집합
 - 키가 되는 속성은 반드시 값이 달라서 투플들을 서로 구별할 수 있어야 함
 - 키는 릴레이션 간의 관계를 맺는 데도 사용됨

 **슈퍼키**
  - 투플을 유일하게 식별할 수 있는 하나의 속성 혹은 속성의 집합
  -> 투플 식별 가능한 속성을 포함한 모든 속성의 집합이 슈퍼키임
    ex) 고객번호와 주민번호가 투플 식별이 가능하다면
    ![image](https://github.com/user-attachments/assets/fc291e61-2ab5-4b17-bac0-bbaf95325bbd)

**후보키**
 - 투플을 유일하게 식별할 수 있는 속성의 최소 집합 -> 효율성 측면에서 중요함
 - 위를 참고해서 보면, 슈퍼키는 많지만, 후보키는 '주민번호', '고객번호'만 될 수 있음
  -> 투플 식별 가능한 속성이 결국 후보키라고 볼 수 도 있음

   ![image](https://github.com/user-attachments/assets/faa424a3-cc19-42d0-bf5c-066c0d942986)

  그림을 보면 고객번호는 1명의 거ㅗ객이 여러 권의 도서를 구입할 수 있으므로 후보키가 될 수 없고,
  도서번호가 2인 '축구 아는 여자'의 경우 두번의 주문 기록이 있어 투플을 유일하게 식별 할 수 없다
  -> but, 고객번호와 도서번호를 합해 키 값으로 하면, (고객번호, 도서번호)가 동일한 주문 기록이 없으므로 모든 투플을 유일하게 식별가능함.
  -->> 두 개 이상의 속성으로 이루어진 키를 **복합키**라고 함

**기본키**
  - 여러 후보키 중 하나를 선정하여 대표로 삼는 키
**기본 키 선정 시 고려사항**
 - 릴레이션 내 투플을 식별할 수 있는 고유한 값을 가져야함
 - NULL 값은 허용하지 않음
 - 키 값의 변동이 일어나지 않아야함
 - 최대한 적은 수의 속성을 가진것이여야 함
   ![image](https://github.com/user-attachments/assets/b7386cc6-2289-4b8f-ad53-058c1eccf7cd)
 - 릴레이션 스키마를 표현할 때 기본키는 다음과 같이 밑줄을 그어 표시함

**대리키, 인조키**
 - 기본키가 보안을 필요로 하거나, 여러 개의 속성으로 구성되어 복잡하거나, 마땅한 기본키가 없을 때는 일련번호 같은 가상의 속성을 만들어 기본키로 삼는 경우
   ![image](https://github.com/user-attachments/assets/cc71afa1-f5fe-411c-a620-76d8ba92e887)

**대체키**
 - 기본키로 선정되지 않은 후보키
 - 고객 릴레이션의 경우 고객번호와 주민번호 중 고객번호를 기본키로 정하면 주민번호가 대체키가 됨

**외래키**
 - 다른 릴레이션의 기본키를 참조하는 속성
 - 참조하고(외래키), 참조되는(기본키) 양쪽 릴레이션의 도메인이 서로 같아야함
 - 참조하는 외래키 값이 참조되는 기본키 값에 연동되어 항상 데이터의 일관성이 유지됨(외래키 제약조건)
 - 외래키 사용시 참조하는 릴레이션과 참조되는 릴레이션이 꼭 다른 릴레이션일 필요는 없음(자기 자신의 기본키 참조 가능)
   ![image](https://github.com/user-attachments/assets/3766e2e0-3163-40b2-8bbc-e3bc793e6ba5)

   ![image](https://github.com/user-attachments/assets/274b0288-974a-436e-9f17-306b314fee7a)
   위의 사진은 자기 자신의 기본키를 참조하는 예시

**외래키의 특징**
 - 관계 데이터 모델에서 릴레이션 간의 관계를 포함함
 - 다른 릴레이션의 기본키를 참조하는 속성
 - 참조하고(외래키) 참조되는(기본키) 양쪽 릴레이션의 도메인은 서로 같아야 함
 - 참조되는(기본키) 값이 변경되면 참조하는(외래키) 값도 변경됨
 - NULL 값과 중복값 등이 허용됨
 - 자기 자신의 기본키를 참조하는 외래키도 가능함
 - 외래키는 기본키의 일부가 될 수 있음

   ![image](https://github.com/user-attachments/assets/c62dda9b-1922-4fc0-9f1e-3df7a27c8ae7)

# 무결성 제약조건

**데이터 무결성(data integrity)**
 - 데이터베이스에 저장된 데이터의 일관성과 정확성을 지키는 것
 - 일관성과 정확성을 바탕으로 구축된 데이터베이스가 계속해서 무결성을 유지하려면 투플의 삽입-삭제-수정 시 데이터의 제약조건 준수 여부를 확인해야함

**무결성 제약조건**
 - 도메인 무결성 제약조건
   - 도메인제약
   - 릴레이션 내의 투플들이 각 속성의 도메인에 지정된 값만 가져야 한다는 조건
 - 개체 무결성 제약조건
   - 기본키 제약
   - 릴레이션은 기본키를 지정하고 그에 따른 무결성 원칙(기본키는 NULL값을 가져서는 안되며 릴레이션 내의 오직 하나의 값만 존재해야 한다)을 지켜야 한다는 조건
 - 참조 무결성 제약조건 --> 외래키는 다른 릴레이션의 기본키 값을 참조해야함( 존재하지 않는 값을 참조 x)
   - 외래키 제약
   - 릴레이션 간의 참조 관계를 선언하는 제약조건

![image](https://github.com/user-attachments/assets/dfafe8bc-1f53-4606-bc22-edeba5538a2f)


 - 부모 릴레이션에서 투플을 삭제할 경우
  ![image](https://github.com/user-attachments/assets/e30bfa68-851b-45d7-87e7-afc07a5dd4de)


# 관계대수

**관계대수(relational algebra)의 개념**
 - 릴레이션에서 원하는 결과를 얻기 위해 대수학의 대수와 같은 연산을 이용하여 질의하는 방법을 기술하는 언어

**관계대수 연산자**
 - 수학에서 연산자란 피연산자에 적용되는 연산기호를 맗ㅁ
 - 관계대수 연산자는 릴레이션 연산에 사용되는 기호
 -> 2개의 그룹으로 분류
    - 순수 관계 연산(관계 데이터 모델을 위해 고안)에 사용되는 연산자
       - 셀렉션, 프로젝션, 조인, 디버전, 개명
    - 일반 집합연산(수학의 집합이론에서 차용)에 사용되는 연산자
       - 합집합, 교집합, 차집합, 카티션프로덕트

![image](https://github.com/user-attachments/assets/5e92b3b3-7001-4718-8c2e-d0f5c971e6e5)

**관계대수식**
 - 관계대수 연산을 수행하기 위한 식
 - 단항 연산자 : 연산자<조건> 릴레이션
 - 이항 연산자: 릴레이션 1 연산자<조건> 릴레이션2
 - 적용 순서 : 괄호(())안의 식이 우선하며 왼쪽에서 오른쪽으로 진행됨

**셀렉션**
![image](https://github.com/user-attachments/assets/0a6654d1-ff17-4703-8964-649bf71f340f)

 - 릴레이션의 **투플**을 추출하기 위한 연산
 - 하나의 릴레이션을 대상으로 하는 단항 연산자

**프로젝션**
![image](https://github.com/user-attachments/assets/712819f9-72b7-4670-9eee-46698068fd72)

 - 릴레이션의 **속성**을 추출하기 위한 단항 연산자

**합집합**
 - 수학의 합집합과 동일한 개념, 두 개의 릴레이션을 합하여 하나의 릴레이션을 반환

**교집합**
 - 합병 가능한 두 릴레이션을 대상으로 하며, 두 릴레이션이 공통으로 가지고 있는 투플을 반환

**차집합**
 - 첫 번째 릴레이션에는 속하고 두 번째 릴레이션에는 속하지 않는 투플을 반환

**카티션 프로덕트**
![image](https://github.com/user-attachments/assets/aff9291d-de10-495d-9e44-6b2d56ff7add)

 - 수평적 연산으로, 카티션 프로덕트는 두 릴레이션을 연결시켜 하나로 합칠때 사용
 - 결과 릴레이션 첫 번째 릴레이션의 오른쪽에 두 번째 릴레이션의 모든 투플을 순서대로 배열하여 반환
 - 속성과 도메인이 같을 필요는 없다
 - 결과 릴레이션의 차수는 두 릴레이션의 차수의 합
 - 카디날리티는 두 릴레이션의 카디날리티의 곱
   ![image](https://github.com/user-attachments/assets/b92bdeca-0da7-4621-9021-02e104b75403)

**조인**
![image](https://github.com/user-attachments/assets/3aebc2e4-7211-4829-aba2-489f111f8cfe)

 - 두 릴레이션의 공통 속성을 기준으로 속성값이 같은 투플을 수평으로 결합하는 연산
 - 조인 연산자는 기본 연산자의 조합으로 구현할 수 있는 유도된 연산자
 - 조인 연산의 결과는 공통 속성의 속성값이 동일한 투플만 반환

**기본 조인 연산**
 - 세타조인 : ![image](https://github.com/user-attachments/assets/506716da-27fe-4d51-aa2b-da46aba11758)
 두 릴레이션 간의 속성 값을 비교하여 조건에 맞는 투플을 반환함
 - 동등조인 : 속성값이 같은 투플만 반환
 - 자연조인 : 속성 이름이 같은 투플만 대상으로 하되 중복 속성을 제거하고 반환함

**확장된 조인 연산**
 - 세미조인 : 두 릴레이션을 조인한 후 한 릴레이션의 투플만 반환
 - 외부조인 : 조인에 실패한 값들을 NULL값으로 채워서 반환
 - 세타조인 : 조인에 참여하는 두 릴레이션의 속성값을 비교하여 조건을 만족하는 투플만 반환함(r은 R의 속성, s는 S의 속성)
   ![image](https://github.com/user-attachments/assets/63832d6f-8e00-4bb2-a382-da0f38f4248d)
 - 동등조인 : 세타조인에서 = 연산자를 사용한 조인을 말함, 보통 조인 연산이라고 하면 동등조인을 지칭
   ![image](https://github.com/user-attachments/assets/60e8a89b-486b-40a8-898a-2097d11b8b77)

   


   

